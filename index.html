<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jayasooriya Transport - Transport Management</title>
    <link rel="icon" href="https://i.postimg.cc/x19FXbdR/New-Transport-Logo.png" type="image/png">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <style>
        .text-center {
            text-align: center;
        }
        /* Add this style for the loading checkbox */
        .loading-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>
    <div id="loginSection" class="login-container">
        <div class="login-box">
            <img src="https://i.postimg.cc/x19FXbdR/New-Transport-Logo.png" alt="Jayasooriya Enterprises Logo" class="login-logo">
            <h2>JAYASOORIYA TRANSPORT</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Username:</label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit">Login</button>
                <p id="loginError" class="error-message"></p>
            </form>
        </div>
    </div>

    <div id="appSection" style="display: none;">
        <header>
            <div class="header-left">
                <span class="header-company-name">JAYASOORIYA TRANSPORT - TRANSPORT MANAGEMENT SYSTEM</span>
            </div>
            <div class="header-right">
                <span class="admin-info"><i class="fas fa-user-tie"></i> Administrator</span>
                <button id="logoutBtn" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </header>

        <div class="app-container">
            <nav class="sidebar">
                <div class="sidebar-header">
                    <img src="https://i.postimg.cc/x19FXbdR/New-Transport-Logo.png" alt="Jayasooriya Enterprises Logo" class="sidebar-logo">
                </div>
                <button id="vehiclesTab" class="active"><i class="fas fa-truck"></i> Vehicles</button>
                <button id="driversTab"><i class="fas fa-user"></i> Drivers</button>
                <button id="hiresTab"><i class="fas fa-clipboard-list"></i> Vehicle Hires</button>
                <button id="advancePaymentsTab"><i class="fas fa-money-bill-wave"></i> Advance Payments</button>
            </nav>

            <main class="content-area">
                <section id="vehiclesSection" class="active">
                    <div class="section-header">
                        <h2>Vehicle Management</h2>
                        <button id="addVehicleBtn" class="add-btn"><i class="fas fa-plus-circle"></i> Add Vehicle</button>
                    </div>
                    <p class="section-description">Manage your fleet vehicles and their details</p>
                    <div class="table-container">
                        <table id="vehiclesTable">
                            <thead>
    <tr>
        <th>Vehicle Number</th>
        <th>Size (ft)</th>
        <th>Min. Hire</th>
        <th>Tier 1 (0-100km)</th>
        <th>Tier 2 (100-250km)</th>
        <th>Tier 3 (250km+)</th>
        <th>Waiting Price (0-24hrs)</th>
        <th>Waiting Price (24+hrs)</th>
        <th>Loading Charge</th>
        <th>Ownership</th>
        <th>Actions</th>
    </tr>
</thead>
                            <tbody id="vehiclesList">
                                </tbody>
                        </table>
                    </div>
                </section>

                <section id="driversSection">
                    <div class="section-header">
                        <h2>Driver Management</h2>
                        <button id="addDriverBtn" class="add-btn"><i class="fas fa-plus-circle"></i> Add Driver</button>
                    </div>
                    <p class="section-description">Manage your drivers and their personal information</p>
                    <div class="table-container">
                        <table id="driversTable">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>License Number</th>
                                    <th>Age</th>
                                    <th>Address</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="driversList">
                                </tbody>
                        </table>
                    </div>
                </section>

                <section id="hiresSection">
                    <div class="section-header">
                        <h2>Vehicle Hire Management</h2>
                        <button id="addHireBtn" class="add-btn"><i class="fas fa-plus-circle"></i> Add Hire</button>
                    </div>
                    <p class="section-description">Track and manage all vehicle hires</p>
                    <div class="table-container">
                        <div class="filter-container">
                            <label for="filterMonth">Filter by Month:</label>
                            <select id="filterMonth">
                                <option value="All">All Months</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                            <label for="filterVehicle">Filter by Vehicle:</label>
                            <select id="filterVehicle">
                                <option value="All">All Vehicles</option>
                            </select>
                            <button id="applyFilter"><i class="fas fa-filter"></i> Apply Filter</button>
                            <button id="exportPdfBtn" class="pdf-btn"><i class="fas fa-file-pdf"></i> Export PDF</button>
                        </div>
                        <table id="hiresTable">
                            <thead>
                                <tr>
                                    <th class="text-center">Date</th>
                                    <th class="text-center">Vehicle</th>
                                    <th class="text-center">From</th>
                                    <th class="text-center">To</th>
                                    <th class="text-center">Distance (KM)</th>
                                    <th class="text-center">Fuel (L)</th>
                                    <th class="text-center">Fuel Price/L</th>
                                    <th class="text-center">Fuel Cost</th>
                                    <th class="text-center">Waiting (Hrs)</th>
                                    <th class="text-center">Waiting Cost</th>
                                    <th class="text-center">Loading</th>
                                    <th class="text-center">Loading Charge</th>
                                    <th class="text-center">Driver</th>
                                    <th class="text-center">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="hiresList">
                                </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="4" class="text-center">Total</td>
                                    <td id="totalDistance" class="text-center">0.0</td>
                                    <td colspan="2"></td>
                                    <td id="totalFuelCost" class="text-center">0.00</td>
                                    <td></td>
                                    <td id="totalWaitingCost" class="text-center">0.00</td>
                                    <td colspan="2" class="text-center"></td>
                                    <td></td>
                                    <td class="text-center"></td>
                                </tr>
                                <tr>
                                    <td colspan="10" class="text-center">Net Income</td>
                                    <td colspan="2" id="netIncome" class="text-center">0.00</td>
                                    <td colspan="2"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </section>

                <section id="advancePaymentsSection">
                    <div class="section-header">
                        <h2>Advance Payments</h2>
                        <button id="addAdvancePaymentBtn" class="add-btn"><i class="fas fa-plus-circle"></i> Add Advance Payment</button>
                    </div>
                    <p class="section-description">Manage advance payments made to drivers</p>
                    <div class="table-container">
                        <table id="advancePaymentsTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Vehicle</th>
                                    <th>Month</th>
                                    <th>Amount (LKR)</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="advancePaymentsList">
                                </tbody>
                        </table>
                    </div>
                </section>
            </main>
        </div>
        
        <div id="addVehicleModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Add New Vehicle</h3>
                <form id="vehicleForm">
                    <div class="form-group">
                        <label for="vehicleNumber">Vehicle Number:</label>
                        <input type="text" id="vehicleNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="vehicleSize">Vehicle Size (ft):</label>
                        <input type="number" id="vehicleSize" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="minimumHire">Minimum Hire (LKR):</label>
                        <input type="number" id="minimumHire" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="tier1Distance">Tier 1 Distance (0-100km):</label>
                        <input type="number" id="tier1Distance" value="100" readonly>
                    </div>
                    <div class="form-group">
                        <label for="tier1Price">Tier 1 Price (LKR/km):</label>
                        <input type="number" id="tier1Price" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="tier2Distance">Tier 2 Distance (100-250km):</label>
                        <input type="number" id="tier2Distance" value="250" readonly>
                    </div>
                    <div class="form-group">
                        <label for="tier2Price">Tier 2 Price (LKR/km):</label>
                        <input type="number" id="tier2Price" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="tier3Price">Tier 3 Price (LKR/km):</label>
                        <input type="number" id="tier3Price" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="waitingPrice1">Waiting Price (0-24hrs) (LKR/hr):</label>
                        <input type="number" id="waitingPrice1" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="waitingPrice2">Waiting Price (24+hrs) (LKR/hr):</label>
                        <input type="number" id="waitingPrice2" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="loadingCharge">Loading Charge (LKR):</label>
                        <input type="number" id="loadingCharge" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="ownership">Ownership:</label>
                        <select id="ownership" required>
                            <option value="company">Company</option>
                            <option value="outside">Outside</option>
                        </select>
                    </div>
                    <button type="submit"><i class="fas fa-plus-circle"></i> Add Vehicle</button>
                </form>
            </div>
        </div>

        <div id="editVehicleModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Edit Vehicle</h3>
                <form id="editVehicleForm">
                    <input type="hidden" id="editVehicleId">
                    <div class="form-group">
                        <label for="editVehicleNumber">Vehicle Number:</label>
                        <input type="text" id="editVehicleNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="editVehicleSize">Vehicle Size (ft):</label>
                        <input type="number" id="editVehicleSize" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="editMinimumHire">Minimum Hire (LKR):</label>
                        <input type="number" id="editMinimumHire" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editTier1Price">Tier 1 Price (LKR/km):</label>
                        <input type="number" id="editTier1Price" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editTier2Price">Tier 2 Price (LKR/km):</label>
                        <input type="number" id="editTier2Price" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editTier3Price">Tier 3 Price (LKR/km):</label>
                        <input type="number" id="editTier3Price" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editWaitingPrice1">Waiting Price (0-24hrs) (LKR/hr):</label>
                        <input type="number" id="editWaitingPrice1" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editWaitingPrice2">Waiting Price (24+hrs) (LKR/hr):</label>
                        <input type="number" id="editWaitingPrice2" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editLoadingCharge">Loading Charge (LKR):</label>
                        <input type="number" id="editLoadingCharge" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label for="editOwnership">Ownership:</label>
                        <select id="editOwnership" required>
                            <option value="company">Company</option>
                            <option value="outside">Outside</option>
                        </select>
                    </div>
                    <button type="submit"><i class="fas fa-sync-alt"></i> Update Vehicle</button>
                </form>
            </div>
        </div>
        
        <div id="addDriverModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Add New Driver</h3>
                <form id="driverForm">
                    <div class="form-group">
                        <label for="driverName">Name:</label>
                        <input type="text" id="driverName" required>
                    </div>
                    <div class="form-group">
                        <label for="licenseNumber">License Number:</label>
                        <input type="text" id="licenseNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="driverAge">Age:</label>
                        <input type="number" id="driverAge" required>
                    </div>
                    <div class="form-group">
                        <label for="driverAddress">Address:</label>
                        <textarea id="driverAddress" required></textarea>
                    </div>
                    <button type="submit"><i class="fas fa-plus-circle"></i> Add Driver</button>
                </form>
            </div>
        </div>

        <div id="editDriverModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Edit Driver</h3>
                <form id="editDriverForm">
                    <input type="hidden" id="editDriverId">
                    <div class="form-group">
                        <label for="editDriverName">Name:</label>
                        <input type="text" id="editDriverName" required>
                    </div>
                    <div class="form-group">
                        <label for="editLicenseNumber">License Number:</label>
                        <input type="text" id="editLicenseNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="editDriverAge">Age:</label>
                        <input type="number" id="editDriverAge" required>
                    </div>
                    <div class="form-group">
                        <label for="editDriverAddress">Address:</label>
                        <textarea id="editDriverAddress" required></textarea>
                    </div>
                    <button type="submit"><i class="fas fa-sync-alt"></i> Update Driver</button>
                </form>
            </div>
        </div>

        <div id="addHireModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Add New Vehicle Hire</h3>
                <form id="hireForm">
                    <div class="form-group">
                        <label for="hireDate">Date:</label>
                        <input type="date" id="hireDate" required>
                    </div>
                    <div class="form-group">
                        <label for="hireMonth">Month:</label>
                        <select id="hireMonth" required>
                            <option value="">Select Month</option>
                            <option value="January">January</option>
                            <option value="February">February</option>
                            <option value="March">March</option>
                            <option value="April">April</option>
                            <option value="May">May</option>
                            <option value="June">June</option>
                            <option value="July">July</option>
                            <option value="August">August</option>
                            <option value="September">September</option>
                            <option value="October">October</option>
                            <option value="November">November</option>
                            <option value="December">December</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="hireVehicle">Vehicle:</label>
                        <select id="hireVehicle" required>
                            <option value="">Select Vehicle</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="fromLocation">From Location:</label>
                        <input type="text" id="fromLocation" required>
                    </div>
                    <div class="form-group">
                        <label for="toLocation">To Location:</label>
                        <input type="text" id="toLocation" required>
                    </div>
                    <div class="form-group">
                        <label for="distance">Distance (KM):</label>
                        <input type="number" id="distance" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="fuelLiters">Fuel (Liters):</label>
                        <input type="number" id="fuelLiters" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="fuelPricePerLiter">Fuel Price/L (LKR):</label>
                        <input type="number" id="fuelPricePerLiter" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="waitingHours">Waiting Time (Hours):</label>
                        <input type="number" id="waitingHours" step="0.1">
                    </div>
                    <div class="form-group loading-checkbox">
                        <label for="loading">Loading:</label>
                        <input type="checkbox" id="loading">
                    </div>
                    <div class="form-group">
                        <label for="hireDriver">Driver:</label>
                        <select id="hireDriver">
                            <option value="">Select Driver</option>
                        </select>
                    </div>
                    <button type="submit"><i class="fas fa-plus-circle"></i> Add Hire Record</button>
                </form>
            </div>
        </div>

        <div id="editHireModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Edit Hire Record</h3>
                <form id="editHireForm">
                    <input type="hidden" id="editHireId">
                    <div class="form-group">
                        <label for="editHireDate">Date:</label>
                        <input type="date" id="editHireDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editHireMonth">Month:</label>
                        <select id="editHireMonth" required>
                            <option value="January">January</option>
                            <option value="February">February</option>
                            <option value="March">March</option>
                            <option value="April">April</option>
                            <option value="May">May</option>
                            <option value="June">June</option>
                            <option value="July">July</option>
                            <option value="August">August</option>
                            <option value="September">September</option>
                            <option value="October">October</option>
                            <option value="November">November</option>
                            <option value="December">December</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editHireVehicle">Vehicle:</label>
                        <select id="editHireVehicle" required>
                            <option value="">Select Vehicle</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editFromLocation">From Location:</label>
                        <input type="text" id="editFromLocation" required>
                    </div>
                    <div class="form-group">
                        <label for="editToLocation">To Location:</label>
                        <input type="text" id="editToLocation" required>
                    </div>
                    <div class="form-group">
                        <label for="editDistance">Distance (KM):</label>
                        <input type="number" id="editDistance" step="0.1" required>
                    </div>
                    <div class="form-group">
                        <label for="editFuelLiters">Fuel (Liters):</label>
                        <input type="number" id="editFuelLiters" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="editFuelPricePerLiter">Fuel Price/L (LKR):</label>
                        <input type="number" id="editFuelPricePerLiter" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="editWaitingHours">Waiting Time (Hours):</label>
                        <input type="number" id="editWaitingHours" step="0.1">
                    </div>
                    <div class="form-group loading-checkbox">
                        <label for="editLoading">Loading:</label>
                        <input type="checkbox" id="editLoading">
                    </div>
                    <div class="form-group">
                        <label for="editHireDriver">Driver:</label>
                        <select id="editHireDriver">
                            <option value="">Select Driver</option>
                        </select>
                    </div>
                    <button type="submit"><i class="fas fa-sync-alt"></i> Update Hire</button>
                </form>
            </div>
        </div>

        <div id="addAdvancePaymentModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Add New Advance Payment</h3>
                <form id="advancePaymentForm">
                    <div class="form-group">
                        <label for="advancePaymentDate">Date:</label>
                        <input type="date" id="advancePaymentDate" required>
                    </div>
                    <div class="form-group">
                        <label for="advancePaymentMonth">Month:</label>
                        <select id="advancePaymentMonth" required>
                            <option value="">Select Month</option>
                            <option value="January">January</option>
                            <option value="February">February</option>
                            <option value="March">March</option>
                            <option value="April">April</option>
                            <option value="May">May</option>
                            <option value="June">June</option>
                            <option value="July">July</option>
                            <option value="August">August</option>
                            <option value="September">September</option>
                            <option value="October">October</option>
                            <option value="November">November</option>
                            <option value="December">December</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="advancePaymentVehicle">Vehicle:</label>
                        <select id="advancePaymentVehicle" required>
                            <option value="">Select Vehicle</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="advancePaymentAmount">Amount (LKR):</label>
                        <input type="number" id="advancePaymentAmount" step="0.01" required>
                    </div>
                    <button type="submit"><i class="fas fa-plus-circle"></i> Add Payment</button>
                </form>
            </div>
        </div>

        <div id="editAdvancePaymentModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Edit Advance Payment</h3>
                <form id="editAdvancePaymentForm">
                    <input type="hidden" id="editAdvancePaymentId">
                    <div class="form-group">
                        <label for="editAdvancePaymentDate">Date:</label>
                        <input type="date" id="editAdvancePaymentDate" required>
                    </div>
                    <div class="form-group">
                        <label for="editAdvancePaymentMonth">Month:</label>
                        <select id="editAdvancePaymentMonth" required>
                            <option value="January">January</option>
                            <option value="February">February</option>
                            <option value="March">March</option>
                            <option value="April">April</option>
                            <option value="May">May</option>
                            <option value="June">June</option>
                            <option value="July">July</option>
                            <option value="August">August</option>
                            <option value="September">September</option>
                            <option value="October">October</option>
                            <option value="November">November</option>
                            <option value="December">December</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editAdvancePaymentVehicle">Vehicle:</label>
                        <select id="editAdvancePaymentVehicle" required>
                            <option value="">Select Vehicle</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="editAdvancePaymentAmount">Amount (LKR):</label>
                        <input type="number" id="editAdvancePaymentAmount" step="0.01" required>
                    </div>
                    <button type="submit"><i class="fas fa-sync-alt"></i> Update Payment</button>
                </form>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 Jayasooriya Transport. All rights reserved.</p>
        </footer>
    </div>

    <script src="app.js"></script>
</body>
</html>